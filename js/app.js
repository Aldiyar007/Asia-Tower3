"use strict";const body=document.querySelector("body"),header=document.querySelector("header.header"),menuBody=document.querySelector(".header__menu"),menuBurger=document.querySelector(".header__burger");let numOffClicks=0;function disable(){const e=window.scrollY;body.classList.add("lock"),body.dataset.position=e,body.style.top=-e+"px"}function enable(){const e=parseInt(body.dataset.position,10);body.style.top="auto",body.classList.remove("lock"),window.scroll({top:e,left:0}),body.removeAttribute("class")}function addClass(){menuBurger.classList.add("active"),menuBody.classList.add("active"),header.classList.add("not-opacity")}function removeClass(){menuBurger.classList.remove("active"),menuBody.classList.remove("active"),header.classList.remove("not-opacity")}menuBurger&&menuBurger.addEventListener("click",(function(){numOffClicks++,numOffClicks%2!=0?(addClass(),disable()):(removeClass(),enable(),body.removeAttribute("data-position"))})),window.addEventListener("scroll",(function(){let e=window.scrollY;document.querySelectorAll(".block").forEach(((t,o)=>{t.offsetTop-header.clientHeight<e&&(document.querySelectorAll(".header__link").forEach((e=>{e.classList.contains("active-page")&&e.classList.remove("active-page")})),document.querySelectorAll(".header__menu li")[o].querySelector("a").classList.add("active-page"))}))}));const menuLinks=document.querySelectorAll(".link[data-goto]");if(menuLinks.length>0)for(let e=0;e<menuLinks.length;e++)menuLinks.forEach((e=>{e.addEventListener("click",(function(e){const t=e.target;if(t.dataset.goto&&document.querySelector(t.dataset.goto)){const o=document.querySelector(t.dataset.goto).getBoundingClientRect().top+pageYOffset-header.offsetHeight+20;console.log(o),menuBurger&&menuBurger.classList.contains("active")&&(numOffClicks++,removeClass(),enable()),window.scrollTo({top:o,behavior:"smooth"}),e.preventDefault()}}))}));let backToTopEL=document.querySelector(".back-to-top");function backToTop(){window.addEventListener("scroll",(function(){window.pageYOffset>=200?backToTopEL.classList.add("open"):backToTopEL.classList.remove("open")}));const e=document.querySelectorAll(".smooth");for(let t of e)t.addEventListener("click",(function(e){e.preventDefault();const o=t.getAttribute("href").replace("#","");document.querySelector(o).scrollIntoView({behavior:"smooth",block:"start"})}))}backToTop();const popupLinks=document.querySelectorAll(".popup-link"),lockPadding=document.querySelectorAll(".lock-padding");let unlock=!0;const timeout=800;if(popupLinks.length>0)for(let e=0;e<popupLinks.length;e++){const t=popupLinks[e];t.addEventListener("click",(function(e){const o=t.getAttribute("href").replace("#","");popupOpen(document.getElementById(o)),e.preventDefault()}))}const popupCLoseIcon=document.querySelectorAll(".close-popup");if(popupCLoseIcon.length>0)for(let e=0;e<popupCLoseIcon.length;e++){const t=popupCLoseIcon[e];t.addEventListener("click",(function(e){popupClose(t.closest(".popup")),e.preventDefault()}))}function popupOpen(e){if(e&&unlock){const t=document.querySelector(".popup.open");t?popupClose(t,!1):bodyLock(),e.classList.add("open"),document.querySelector("#dws-form").checked=!1,e.addEventListener("click",(function(e){e.target.closest(".popup__content")||popupClose(e.target.closest(".popup"))}))}}function popupClose(e,t=!0){unlock&&(e.classList.remove("open"),t&&bodyUnlock())}function bodyLock(){const e=window.innerWidth-document.querySelector(".content").offsetWidth+"px";if(lockPadding.length>0)for(let t=0;t<lockPadding.length;t++){const o=lockPadding[t];o.style.transition="0s",o.style.paddingRight=e}disable(),body.style.paddingRight=e,unlock=!1,setTimeout((function(){unlock=!0}),800)}function bodyUnlock(){setTimeout((function(){if(lockPadding.length>0)for(let e=0;e<lockPadding.length;e++){const t=lockPadding[e];t.style.transition="0s",t.style.paddingRight="0px"}enable();for(let e=0;e<lockPadding.length;e++){const t=lockPadding[e];t.removeAttribute("style"),t.style.transition=".5s"}body.style.paddingRight="0px"}),800),unlock=!1,setTimeout((function(){unlock=!0}),800)}function Focus(e){e.parentElement.classList.add("focus")}function Blur(e){""===e.value.trim()&&e.parentElement.classList.remove("focus")}document.addEventListener("keydown",(function(e){if(27===e.which){popupClose(document.querySelector(".popup.open"))}})),Element.prototype.closest||(Element.prototype.closest=function(e){for(var t=this;t;){if(t.matches(e))return t;t=t.parentElement}return null}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.MatchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector);const form=document.getElementById("form");function wpguruLink(){var e=document.getElementsByTagName("body")[0],t=window.getSelection(),o=document.location.href,n=t+("<br /><br />Источник: <a href='"+o+"'>"+o+"</a><br />© Asia-Tower.kz"),c=document.createElement("div");c.style.position="absolute",c.style.left="-99999px",e.appendChild(c),c.innerHTML=n,t.selectAllChildren(c),window.setTimeout((function(){e.removeChild(c)}),0)}form.length>0&&document.addEventListener("DOMContentLoaded",(function(){function e(e){e.parentElement.classList.add("_error"),e.classList.add("_error")}function t(e){e.parentElement.classList.remove("_error"),e.classList.remove("_error")}function o(e){return!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,8})+$/.test(e.value)}function n(e){return!/^[0-9]+$/.test(e.value)}form.addEventListener("submit",(async function(c){c.preventDefault();let s=function(c){let s=0,l=document.querySelectorAll(".req");for(let c=0;c<l.length;c++){const r=l[c];t(r),r.classList.contains("email")?o(r)&&(e(r),s++):r.classList.contains("phone")?n(r)&&(e(r),s++):("checkbox"===r.getAttribute("type")&&!1===r.checked||""===r.value)&&(e(r),s++)}return s}(),l=new FormData(form);if(0===s){form.classList.add("_sending");let e=await fetch("sendmail.php",{method:"POST",body:l});if(e.ok){let t=await e.json();alert(t.message),document.querySelectorAll(".user-input").reset(),form.classList.remove("_sending")}else alert("Ошибка соединения. Повторите попытку позже"),form.classList.remove("_sending")}else alert("Введите обязательные поля корректно!")}))})),window.onscroll=function(){window.pageYOffset>140?header.classList.add("active__scroll"):header.classList.remove("active__scroll")},document.oncopy=wpguruLink;